<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>UKHLS exploration (weighted kin) 4.6 (2)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/clipboard/clipboard.min.js"></script>
<script src="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/quarto-html/quarto.js"></script>
<script src="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/quarto-html/popper.min.js"></script>
<script src="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/quarto-html/anchor.min.js"></script>
<link href="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="UKHLS exploration (weighted kin) 4.6(merging fa ma)_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">UKHLS exploration (weighted kin) 4.6 (2)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="reading-and-cleaning-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-and-cleaning-data">Reading and cleaning data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#houskeeping</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Clear objects already in the environment – start with a clean slate</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#loading libraries</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svyVGAM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: VGAM
Loading required package: stats4
Loading required package: splines
Loading required package: survey
Loading required package: grid
Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack

Loading required package: survival

Attaching package: 'survey'

The following object is masked from 'package:VGAM':

    calibrate

The following object is masked from 'package:graphics':

    dotchart</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjlabelled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'sjlabelled' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'sjlabelled'

The following object is masked from 'package:forcats':

    as_factor

The following object is masked from 'package:dplyr':

    as_label

The following object is masked from 'package:ggplot2':

    as_label</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(desctable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'desctable' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pander</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'pander' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'desctable'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test, IQR</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'summarytools' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'summarytools'

The following object is masked from 'package:sjlabelled':

    unlabel

The following object is masked from 'package:tibble':

    view</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'naniar' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svrep)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Hmisc'

The following objects are masked from 'package:summarytools':

    label, label&lt;-

The following object is masked from 'package:survey':

    deff

The following objects are masked from 'package:dplyr':

    src, summarize

The following objects are masked from 'package:base':

    format.pval, units</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'srvyr'

The following object is masked from 'package:Hmisc':

    summarize

The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'haven'

The following objects are masked from 'package:sjlabelled':

    as_factor, read_sas, read_spss, read_stata, write_sas, zap_labels</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(catregs)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'modelsummary'

The following object is masked from 'package:Hmisc':

    Mean

The following object is masked from 'package:VGAM':

    Max</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'mice' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mice'

The following object is masked from 'package:stats':

    filter

The following objects are masked from 'package:base':

    cbind, rbind</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: 

 Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.
 R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'texreg' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Version:  1.39.3
Date:     2023-11-09
Author:   Philip Leifeld (University of Essex)

Consider submitting praise using the praise or praise_interactive functions.
Please cite the JSS article in your publications -- see citation("texreg").

Attaching package: 'texreg'

The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'VIM' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: colorspace
VIM is ready to use.

Suggestions and bug-reports can be submitted at: https://github.com/statistikat/VIM/issues

Attaching package: 'VIM'

The following object is masked from 'package:VGAM':

    wine

The following object is masked from 'package:datasets':

    sleep</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cross-wave-dat" class="level3">
<h3 class="anchored" data-anchor-id="cross-wave-dat">Cross-wave dat</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>inpath<span class="ot">&lt;-</span><span class="st">"D:/r git projects/ox-R/final essay/UKHLS n BHPS stata/UKDA-6614-stata/stata/stata13_se/"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>xwavedat<span class="ot">&lt;-</span><span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/xwavedat.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,maju,paju,maedqf,paedqf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>missval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">9</span>, <span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  xwavedat<span class="ot">&lt;-</span> xwavedat <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wave1" class="level3">
<h3 class="anchored" data-anchor-id="wave1">Wave1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 1 </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>a_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/a_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp, a_mastat_dv, a_strata, a_psu,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>         a_indinus_xw,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>         a_age_dv, a_sex_dv, a_hiqual_dv,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>         a_mastat_dv, a_racel_dv,a_fimnnet_dv,a_lvrel1,a_lvrel2,a_pns1pno,a_pns2pno,a_nchild_dv,a_urban_dv,a_panssec8_dv,a_manssec8_dv)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>a_indrespj<span class="ot">&lt;-</span>a_indresp<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,a_panssec8_dv,a_manssec8_dv)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>You have loaded plyr after dplyr - this is likely to cause problems.
If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
library(plyr); library(dplyr)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:srvyr':

    mutate, rename, summarise, summarize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:Hmisc':

    is.discrete, summarize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    compact</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="ot">&lt;-</span><span class="fu">join_all</span>(<span class="fu">list</span>(a_indresp,xwavedat), <span class="at">by=</span><span class="st">'pidp'</span>, <span class="at">type=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rename pa ses, job and edu columns</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>a_indresp <span class="ot">&lt;-</span>a_indresp<span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">pases=</span>a_panssec8_dv,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mases=</span>a_manssec8_dv</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wave-212" class="level3">
<h3 class="anchored" data-anchor-id="wave-212">Wave 2~12</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 2</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>b_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/b_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,b_panssec8_dv,b_manssec8_dv)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 3</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>c_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/c_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,c_panssec8_dv,c_manssec8_dv)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 4</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>d_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/d_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,d_panssec8_dv,d_manssec8_dv)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 5</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>e_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/e_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,e_panssec8_dv,e_manssec8_dv)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 6</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>f_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/f_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,f_panssec8_dv,f_manssec8_dv)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 7</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>g_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/g_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,g_panssec8_dv,g_manssec8_dv)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 8</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>h_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/h_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,h_panssec8_dv,h_manssec8_dv)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 9</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>i_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/i_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,i_panssec8_dv,i_manssec8_dv)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 10</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>j_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/j_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,j_panssec8_dv,j_manssec8_dv)</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 11</span></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>k_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/k_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,k_panssec8_dv,k_manssec8_dv)</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 12</span></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>l_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/l_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp,l_panssec8_dv,l_manssec8_dv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wave13" class="level3">
<h3 class="anchored" data-anchor-id="wave13">Wave13</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 13</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>m_indresp <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file=</span><span class="fu">paste0</span>(inpath, <span class="st">"ukhls/m_indresp.dta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(pidp, m_mastat_dv, m_strata, m_psu, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>         m_indpxui_xw,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>         m_age_dv, m_sex_dv, m_hiqual_dv, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>         m_mastat_dv, m_racel_dv,m_fimnnet_dv,m_lvrel1,m_lvrel2,m_lvrel9,m_lvrel10,m_pns1pno,m_pns2pno,m_nchild_dv,m_urban_dv,m_panssec8_dv,m_manssec8_dv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recode missing values for all variables using for loop and mutate_all</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  a_indresp<span class="ot">&lt;-</span> a_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  a_indrespj<span class="ot">&lt;-</span> a_indrespj <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  b_indresp<span class="ot">&lt;-</span> b_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  c_indresp<span class="ot">&lt;-</span> c_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  d_indresp<span class="ot">&lt;-</span> d_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  e_indresp<span class="ot">&lt;-</span> e_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  f_indresp<span class="ot">&lt;-</span> f_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  g_indresp<span class="ot">&lt;-</span> g_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  h_indresp<span class="ot">&lt;-</span> h_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>  i_indresp<span class="ot">&lt;-</span> i_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>  j_indresp<span class="ot">&lt;-</span> j_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>  k_indresp<span class="ot">&lt;-</span> k_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>  l_indresp<span class="ot">&lt;-</span> l_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>  m_indresp<span class="ot">&lt;-</span> m_indresp <span class="sc">%&gt;%</span></span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(., <span class="fu">list</span>(<span class="sc">~</span><span class="fu">na_if</span>(., missval[i])))</span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 13 join</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="ot">&lt;-</span><span class="fu">join_all</span>(<span class="fu">list</span>(m_indresp,a_indrespj,b_indresp,c_indresp,d_indresp,e_indresp,f_indresp,g_indresp,h_indresp,i_indresp,j_indresp,k_indresp,l_indresp,xwavedat), <span class="at">by=</span><span class="st">'pidp'</span>, <span class="at">type=</span><span class="st">'left'</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="ot">&lt;-</span>m_indresp<span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mases=</span><span class="fu">coalesce</span>(a_manssec8_dv,b_manssec8_dv,c_manssec8_dv,d_manssec8_dv,e_manssec8_dv,f_manssec8_dv,g_manssec8_dv,h_manssec8_dv,i_manssec8_dv,j_manssec8_dv,k_manssec8_dv,l_manssec8_dv,m_manssec8_dv),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pases=</span><span class="fu">coalesce</span>(a_panssec8_dv,b_panssec8_dv,c_panssec8_dv,d_panssec8_dv,e_panssec8_dv,f_panssec8_dv,g_panssec8_dv,h_panssec8_dv,i_panssec8_dv,j_panssec8_dv,k_panssec8_dv,l_panssec8_dv,m_panssec8_dv)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..2` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..3` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..4` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..5` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..6` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..7` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..8` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..9` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..10` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..11` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..12` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `..1` and `..13` have conflicting value labels.
ℹ Labels for these values will be taken from `..1`.
✖ Values: -7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(missval,a_indrespj,b_indresp,c_indresp,d_indresp,e_indresp,f_indresp,g_indresp,h_indresp,i_indresp,j_indresp,k_indresp,l_indresp,xwavedat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="cleaning-data" class="level1">
<h1>Cleaning data</h1>
<section id="wave-1" class="level3">
<h3 class="anchored" data-anchor-id="wave-1">Wave 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>a_sex_dv[a_indresp<span class="sc">$</span>a_sex_dv<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>a_fimnnet_dv[a_indresp<span class="sc">$</span>a_fimnnet_dv<span class="sc">&lt;</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing variables for analysis (wave 1)</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#num of parents</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lvpam<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lvpam[a_indresp<span class="sc">$</span>a_pns1pno<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lvpaf<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lvpaf[a_indresp<span class="sc">$</span>a_pns2pno<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>parentnum<span class="ot">&lt;-</span>a_indresp<span class="sc">$</span>a_lvrel1<span class="sc">+</span>a_indresp<span class="sc">$</span>a_lvrel2<span class="sc">+</span>a_indresp<span class="sc">$</span>lvpam<span class="sc">+</span>a_indresp<span class="sc">$</span>lvpaf</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co">#living with parents or not (biological/step/adoptive)</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lvpa<span class="ot">&lt;-</span>a_indresp<span class="sc">$</span>lvpam<span class="sc">+</span>a_indresp<span class="sc">$</span>lvpaf</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="ot">&lt;-</span>a_indresp<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>lvpam,<span class="sc">-</span>lvpaf)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="co">#binary</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lvpab<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lvpab[a_indresp<span class="sc">$</span>lvpa<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="co">#level of education completed</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>edu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>edu[a_indresp<span class="sc">$</span>a_hiqual_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">9</span>)]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#low (everything below)</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>edu[a_indresp<span class="sc">$</span>a_hiqual_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#middle (completed A-level or secondary high school)</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>edu[a_indresp<span class="sc">$</span>a_hiqual_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#high (have a degree)</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>edu[a_indresp<span class="sc">$</span>edu<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">attr</span>(a_indresp<span class="sc">$</span>a_hiqual_dv,<span class="st">"labels"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     missing inapplicable      refusal   don't know       Degree Other higher 
          -9           -8           -2           -1            1            2 
 A level etc     GCSE etc   Other qual      No qual 
           3            4            5            9 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>edu<span class="ot">&lt;-</span><span class="fu">factor</span>(a_indresp<span class="sc">$</span>edu,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">"middle"</span>,<span class="st">"high"</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">#making nchild_dv a binary variable</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>child<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>child[a_indresp<span class="sc">$</span>a_nchild_dv<span class="sc">&gt;=</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co">#age group</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>age_group<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>age_group[a_indresp<span class="sc">$</span>a_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">20</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>age_group[a_indresp<span class="sc">$</span>a_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>age_group[a_indresp<span class="sc">$</span>a_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">26</span><span class="sc">:</span><span class="dv">30</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>age_group[a_indresp<span class="sc">$</span>a_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">31</span><span class="sc">:</span><span class="dv">35</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>age_group<span class="ot">&lt;-</span><span class="fu">factor</span>(a_indresp<span class="sc">$</span>age_group,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>))</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="co">#logarithm of income</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lnincome<span class="ot">&lt;-</span><span class="fu">log</span>(a_indresp<span class="sc">$</span>a_fimnnet_dv)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co">#add 1 to all income values to avoid -inf in log transformation</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>incomeadd<span class="ot">&lt;-</span>a_indresp<span class="sc">$</span>a_fimnnet_dv<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>lnincome<span class="ot">&lt;-</span><span class="fu">log</span>(a_indresp<span class="sc">$</span>incomeadd)</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="ot">&lt;-</span>a_indresp<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>incomeadd)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="co">#racel groups </span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>racel<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>racel[a_indresp<span class="sc">$</span>a_racel_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#Whites</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>racel[a_indresp<span class="sc">$</span>a_racel_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">15</span>)]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#African Caribbean</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>racel[a_indresp<span class="sc">$</span>a_racel_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#Indiani,Pakistani, Bangladeshi</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>racel[a_indresp<span class="sc">$</span>a_racel_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">13</span>)]<span class="ot">&lt;-</span><span class="dv">4</span> <span class="co">#Other Asian</span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>racel[a_indresp<span class="sc">$</span>racel<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">5</span> <span class="co">#Other</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>racel<span class="ot">&lt;-</span><span class="fu">factor</span>(a_indresp<span class="sc">$</span>racel,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Whites"</span>,<span class="st">"African Caribbean"</span>,<span class="st">"Indiani,Pakistani, Bangladeshi"</span>,<span class="st">"Other Asian"</span>,<span class="st">"Other"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#father ses</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">8</span>]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#Routine </span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">7</span>]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#Semi-routine </span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">6</span>]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#Lower supervisory &amp; technical</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="dv">4</span> <span class="co">#Small employers &amp; own account</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">4</span>]<span class="ot">&lt;-</span><span class="dv">5</span> <span class="co">#Intermediate </span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">3</span>]<span class="ot">&lt;-</span><span class="dv">6</span> <span class="co">#Lower management &amp; professional</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="dv">7</span> <span class="co">#Higher professional</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">8</span> <span class="co">#Large employers &amp; higher management </span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="co">#dummy variable for pases missing</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co">#a_indresp$fasesna&lt;-ifelse(a_indresp$fases==0, 1, 0)</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fases[a_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>fasesXage<span class="ot">&lt;-</span>a_indresp<span class="sc">$</span>fases<span class="sc">*</span>a_indresp<span class="sc">$</span>a_age_dv</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="co">#for parental education</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="co">#father</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>paedu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>paedu[a_indresp<span class="sc">$</span>paedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">97</span>)]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#low (everything below, the category "other" is included)</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>paedu[a_indresp<span class="sc">$</span>paedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#middle (complete A-level or have some qualifications)</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>paedu[a_indresp<span class="sc">$</span>paedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">5</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#high (have a degree)</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>paedu[a_indresp<span class="sc">$</span>paedu<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>paedu<span class="ot">&lt;-</span><span class="fu">factor</span>(a_indresp<span class="sc">$</span>paedu,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">"middle"</span>,<span class="st">"high"</span>))</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="co">#mother</span></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>maedu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>maedu[a_indresp<span class="sc">$</span>maedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">97</span>)]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#low (everything below, the category "other" is included)</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>maedu[a_indresp<span class="sc">$</span>maedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#middle (complete A-level or have some qualifications)</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>maedu[a_indresp<span class="sc">$</span>maedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">5</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#high (have a degree)</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>maedu[a_indresp<span class="sc">$</span>maedu<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>maedu<span class="ot">&lt;-</span><span class="fu">factor</span>(a_indresp<span class="sc">$</span>maedu,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">"middle"</span>,<span class="st">"high"</span>))</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a><span class="co">#for whether mother working at age 14</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>mawork<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>mawork[a_indresp<span class="sc">$</span>maju<span class="sc">==</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#notworking</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>mawork[a_indresp<span class="sc">$</span>maju<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#working</span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>mawork[a_indresp<span class="sc">$</span>maju<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#Mother deceased/Mother not living with respondent so don't know</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>mawork[a_indresp<span class="sc">$</span>mawork<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span> <span class="co">#missing</span></span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>mawork<span class="ot">&lt;-</span><span class="fu">factor</span>(a_indresp<span class="sc">$</span>mawork,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"notworking"</span>,<span class="st">"working"</span>,<span class="st">"Mother deceased/not living with respondent"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing dependent variables for multinomial regression (wave 1)</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="do">##patterns of home-leaving</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="do">###living with parents(including those who have children)========================</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>leave[a_indresp<span class="sc">$</span>lvpa<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 1: to live with a partner ==============================</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>leave[a_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                         a_indresp<span class="sc">$</span>a_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>)  <span class="co">#married </span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">2</span> </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 2: to live without a partner=====================</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>leave[a_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>                         a_indresp<span class="sc">$</span>a_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)  </span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">3</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing dependent variables for multinomial regression (wave 1) </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="do">##patterns of home-leaving (distinguish between marriage and cohabitation) </span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>ledes<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="do">###living with parents(including those who have children)========================</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>ledes[a_indresp<span class="sc">$</span>lvpa<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 1: to live with a partner(marriage) ==============================</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>ledes[a_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>                         a_indresp<span class="sc">$</span>a_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)  <span class="co">#married </span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">2</span> </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 2: to live with a partner(cohabitation) ==============================</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>ledes[a_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>                         a_indresp<span class="sc">$</span>a_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">10</span>)  <span class="co">#in cohabitation</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">3</span> </span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 3: to live without a partner=====================</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>ledes[a_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>                         a_indresp<span class="sc">$</span>a_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)  <span class="co">#others</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">4</span> </span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(a_indresp<span class="sc">$</span>ledes,<span class="st">"labels"</span>)<span class="ot">&lt;-</span><span class="fu">c</span>(</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a><span class="st">"NA:n=13,having missing values in marital status;"</span>, </span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a><span class="st">"1:living with parents;"</span>,</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="st">"2:route out 1:leaving with partner (marriage) ;"</span>,</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a><span class="st">"3:route out 2:leaving with partner (cohabitation);"</span>,</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a><span class="st">"4:route out 3:leaving without a partner"</span>)</span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>a_indresp<span class="sc">$</span>ledes<span class="ot">&lt;-</span><span class="fu">factor</span>(a_indresp<span class="sc">$</span>ledes,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"living with parents"</span>,<span class="st">"leaving with partner (marriage)"</span>,<span class="st">"leaving with partner (cohabitation)"</span>,<span class="st">"leaving without a partner"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wave-13" class="level3">
<h3 class="anchored" data-anchor-id="wave-13">Wave 13</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="ot">&lt;-</span>m_indresp<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(pidp, m_mastat_dv, m_strata, m_psu, </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>         m_indpxui_xw,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>         m_age_dv, m_sex_dv, m_hiqual_dv, </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>         m_mastat_dv, m_racel_dv,m_fimnnet_dv,m_lvrel1,m_lvrel2,m_lvrel9,m_lvrel10,m_pns1pno,m_pns2pno,m_nchild_dv,m_urban_dv,maju,paju,maedqf,paedqf,mases,pases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>m_sex_dv[m_indresp<span class="sc">$</span>m_sex_dv<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>m_fimnnet_dv[m_indresp<span class="sc">$</span>m_fimnnet_dv<span class="sc">&lt;</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing variables for analysis (wave 13)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#num of parents</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lvpam<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lvpam[m_indresp<span class="sc">$</span>m_pns1pno<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lvpaf<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lvpaf[m_indresp<span class="sc">$</span>m_pns2pno<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>parentnum<span class="ot">&lt;-</span>m_indresp<span class="sc">$</span>m_lvrel1<span class="sc">+</span>m_indresp<span class="sc">$</span>m_lvrel2<span class="sc">+</span>m_indresp<span class="sc">$</span>lvpam<span class="sc">+</span>m_indresp<span class="sc">$</span>lvpaf</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co">#living with parents or not (biological/step/adoptive)</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lvpa<span class="ot">&lt;-</span>m_indresp<span class="sc">$</span>lvpam<span class="sc">+</span>m_indresp<span class="sc">$</span>lvpaf</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="ot">&lt;-</span>m_indresp<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>lvpam,<span class="sc">-</span>lvpaf)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="co">#binary</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lvpab<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lvpab[m_indresp<span class="sc">$</span>lvpa<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="co">#level of education completed</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>edu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>edu[m_indresp<span class="sc">$</span>m_hiqual_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">9</span>)]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#low (everything below)</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>edu[m_indresp<span class="sc">$</span>m_hiqual_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#middle (completed A-level or secondary high school)</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>edu[m_indresp<span class="sc">$</span>m_hiqual_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#high (have a degree)</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>edu[m_indresp<span class="sc">$</span>edu<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">attr</span>(m_indresp<span class="sc">$</span>m_hiqual_dv,<span class="st">"labels"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            missing        inapplicable             refusal          don't know 
                 -9                  -8                  -2                  -1 
             Degree Other higher degree         A-level etc            GCSE etc 
                  1                   2                   3                   4 
Other qualification    No qualification 
                  5                   9 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>edu<span class="ot">&lt;-</span><span class="fu">factor</span>(m_indresp<span class="sc">$</span>edu,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">"middle"</span>,<span class="st">"high"</span>))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co">#making nchild_dv a binary variable</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>child<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>child[m_indresp<span class="sc">$</span>m_nchild_dv<span class="sc">&gt;=</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co">#age group</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>age_group<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>age_group[m_indresp<span class="sc">$</span>m_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">20</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>age_group[m_indresp<span class="sc">$</span>m_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>age_group[m_indresp<span class="sc">$</span>m_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">26</span><span class="sc">:</span><span class="dv">30</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>age_group[m_indresp<span class="sc">$</span>m_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">31</span><span class="sc">:</span><span class="dv">35</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>age_group<span class="ot">&lt;-</span><span class="fu">factor</span>(m_indresp<span class="sc">$</span>age_group,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>))</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co">#logarithm of income</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lnincome<span class="ot">&lt;-</span><span class="fu">log</span>(m_indresp<span class="sc">$</span>m_fimnnet_dv)</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="co">#add 1 to all income values to avoid -inf in log transformation</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>incomeadd<span class="ot">&lt;-</span>m_indresp<span class="sc">$</span>m_fimnnet_dv<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>lnincome<span class="ot">&lt;-</span><span class="fu">log</span>(m_indresp<span class="sc">$</span>incomeadd)</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="ot">&lt;-</span>m_indresp<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>incomeadd)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="co">#racel groups </span></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>racel<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>racel[m_indresp<span class="sc">$</span>m_racel_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#Whites</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>racel[m_indresp<span class="sc">$</span>m_racel_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">15</span>)]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#African Caribbean</span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>racel[m_indresp<span class="sc">$</span>m_racel_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#Indiani,Pakistani, Bangladeshi</span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>racel[m_indresp<span class="sc">$</span>m_racel_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">13</span>)]<span class="ot">&lt;-</span><span class="dv">4</span> <span class="co">#Other Asian</span></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>racel[m_indresp<span class="sc">$</span>racel<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">5</span> <span class="co">#Other</span></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>racel<span class="ot">&lt;-</span><span class="fu">factor</span>(m_indresp<span class="sc">$</span>racel,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Whites"</span>,<span class="st">"African Caribbean"</span>,<span class="st">"Indiani,Pakistani, Bangladeshi"</span>,<span class="st">"Other Asian"</span>,<span class="st">"Other"</span>))</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#father ses</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">8</span>]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#Routine </span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">7</span>]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#Semi-routine </span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">6</span>]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#Lower supervisory &amp; technical</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="dv">4</span> <span class="co">#Small employers &amp; own account</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">4</span>]<span class="ot">&lt;-</span><span class="dv">5</span> <span class="co">#Intermediate </span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">3</span>]<span class="ot">&lt;-</span><span class="dv">6</span> <span class="co">#Lower management &amp; professional</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="dv">7</span> <span class="co">#Higher professional</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">8</span> <span class="co">#Large employers &amp; higher management </span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co">#dummy variable for pases missing</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co">#m_indresp$fasesna&lt;-ifelse(m_indresp$fases==0, 1, 0)</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fases[m_indresp<span class="sc">$</span>pases<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>fasesXage<span class="ot">&lt;-</span>m_indresp<span class="sc">$</span>fases<span class="sc">*</span>m_indresp<span class="sc">$</span>m_age_dv</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="co">#for parental education</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a><span class="co">#father</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>paedu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>paedu[m_indresp<span class="sc">$</span>paedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">97</span>)]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#low (everything below, the category "other" is included)</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>paedu[m_indresp<span class="sc">$</span>paedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#middle (complete A-level or have some qualifications)</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>paedu[m_indresp<span class="sc">$</span>paedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">5</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#high (have a degree)</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>paedu[m_indresp<span class="sc">$</span>paedu<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>paedu<span class="ot">&lt;-</span><span class="fu">factor</span>(m_indresp<span class="sc">$</span>paedu,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">"middle"</span>,<span class="st">"high"</span>))</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a><span class="co">#mother</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>maedu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>maedu[m_indresp<span class="sc">$</span>maedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">97</span>)]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#low (everything below, the category "other" is included)</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>maedu[m_indresp<span class="sc">$</span>maedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#middle (complete A-level or have some qualifications)</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>maedu[m_indresp<span class="sc">$</span>maedqf<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">5</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#high (have a degree)</span></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>maedu[m_indresp<span class="sc">$</span>maedu<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>maedu<span class="ot">&lt;-</span><span class="fu">factor</span>(m_indresp<span class="sc">$</span>maedu,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'low'</span>,<span class="st">"middle"</span>,<span class="st">"high"</span>))</span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a><span class="co">#for whether mother working at age 14</span></span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>mawork<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>mawork[m_indresp<span class="sc">$</span>maju<span class="sc">==</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#notworking</span></span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>mawork[m_indresp<span class="sc">$</span>maju<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#working</span></span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>mawork[m_indresp<span class="sc">$</span>maju<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#Mother deceased/Mother not living with respondent so don't know</span></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>mawork[m_indresp<span class="sc">$</span>mawork<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span> <span class="co">#missing</span></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>mawork<span class="ot">&lt;-</span><span class="fu">factor</span>(m_indresp<span class="sc">$</span>mawork,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"notworking"</span>,<span class="st">"working"</span>,<span class="st">"Mother deceased/not living with respondent"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing dependent variables for multinomial regression (wave 1)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="do">##patterns of home-leaving</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="do">###living with parents(including those who have children)========================</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>leave[m_indresp<span class="sc">$</span>lvpa<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 1: to live with a partner ==============================</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>leave[m_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>                         m_indresp<span class="sc">$</span>m_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>)  <span class="co">#married </span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">2</span> </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 2: to live without a partner=====================</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>leave[m_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>                         m_indresp<span class="sc">$</span>m_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)  </span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">3</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing dependent variables for multinomial regression (wave 13) </span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="do">##patterns of home-leaving </span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>ledes<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="do">###living with parents(including those who have children)========================</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>ledes[m_indresp<span class="sc">$</span>lvpa<span class="sc">!=</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 1: to live with a partner(marriage) ==============================</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>ledes[m_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                         m_indresp<span class="sc">$</span>m_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)  <span class="co">#married</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">2</span> </span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 2: to live with a partner(cohabitation) ==============================</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>ledes[m_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>                         m_indresp<span class="sc">$</span>m_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">10</span>)  <span class="co">#in cohabitation</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">3</span> </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="do">##route out 3: to live without a partner=====================</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="do">###females</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>ledes[m_indresp<span class="sc">$</span>lvpa<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="co">#not living with parents</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>                         m_indresp<span class="sc">$</span>m_mastat_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)  <span class="co">#others</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>                         ]<span class="ot">&lt;-</span><span class="dv">4</span> </span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(m_indresp<span class="sc">$</span>ledes,<span class="st">"labels"</span>)<span class="ot">&lt;-</span><span class="fu">c</span>(</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="st">"NA:n=80,having missing values in marital status;"</span>, </span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a><span class="st">"1:living with parents;"</span>,</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a><span class="st">"2:route out 1:leaving with partner (marriage) ;"</span>,</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a><span class="st">"3:route out 2:leaving with partner (cohabitation);"</span>,</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a><span class="st">"4:route out 3:leaving without a partner"</span>)</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>m_indresp<span class="sc">$</span>ledes<span class="ot">&lt;-</span><span class="fu">factor</span>(m_indresp<span class="sc">$</span>ledes,<span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"living with parents"</span>,<span class="st">"leaving with partner (marriage)"</span>,<span class="st">"leaving with partner (cohabitation)"</span>,<span class="st">"leaving without a partner"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-building-with-imputations" class="level2">
<h2 class="anchored" data-anchor-id="model-building-with-imputations">Model building with imputations</h2>
<section id="dealing-with-haven-issues" class="level3">
<h3 class="anchored" data-anchor-id="dealing-with-haven-issues">dealing with haven issues</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="ot">&lt;-</span>a_indresp</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>a_indrespty<span class="ot">&lt;-</span>a_indresp[<span class="fu">which</span>(a_indresp<span class="sc">$</span>a_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">35</span>)),]</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>a_indresptf<span class="ot">&lt;-</span>a_indrespty[<span class="fu">which</span>(a_indrespty<span class="sc">$</span>a_sex_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">2</span>)),]</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="ot">&lt;-</span>m_indresp</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>m_indrespty<span class="ot">&lt;-</span>m_indresp[<span class="fu">which</span>(m_indresp<span class="sc">$</span>m_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">35</span>)),]</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>m_indresptf<span class="ot">&lt;-</span>m_indrespty[<span class="fu">which</span>(m_indrespty<span class="sc">$</span>m_sex_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">2</span>)),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#not ordered: mastat_dv,sex_dv,urban_dv,lvpab,racel,ledes,leave,mawork</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 1</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="ot">&lt;-</span>a_indrespt<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(a_indinus_xw,a_strata,a_psu,a_mastat_dv,a_sex_dv,a_nchild_dv,a_urban_dv,mases,lvpab,edu,age_group,lnincome,racel,fases,fasesXage,paedu,maedu,mawork,leave,ledes)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co">#as numeric</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>a_indinus_xw<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(a_indrespt<span class="sc">$</span>a_indinus_xw)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>lnincome<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(a_indrespt<span class="sc">$</span>lnincome)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>fasesXage<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(a_indrespt<span class="sc">$</span>fasesXage)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>fases<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(a_indrespt<span class="sc">$</span>fases)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>mases<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(a_indrespt<span class="sc">$</span>mases)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="co">#as factor</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>a_mastat_dv<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>a_mastat_dv)</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>a_strata<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>a_strata)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>a_psu<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>a_psu)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>a_nchild_dv<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>a_nchild_dv)</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>lvpab<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>lvpab)</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>racel<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>racel)</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>ledes<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>ledes)</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>leave<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>leave)</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>mawork <span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>mawork)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>edu<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>edu)</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>age_group<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>age_group)</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>paedu <span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>paedu )</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>maedu  <span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>maedu )</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>a_urban_dv<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>a_urban_dv)</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>a_indrespt<span class="sc">$</span>a_sex_dv<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(a_indrespt<span class="sc">$</span>a_sex_dv)</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="co">#wave 13 a_indinus_xw</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="ot">&lt;-</span>m_indrespt<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(m_indpxui_xw,m_strata,m_psu,m_mastat_dv,m_sex_dv,m_nchild_dv,m_urban_dv,mases,lvpab,edu,age_group,lnincome,racel,fases,fasesXage,paedu,maedu,mawork,leave,ledes)</span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a><span class="co">#as numeric</span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>m_indpxui_xw<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(m_indrespt<span class="sc">$</span>m_indpxui_xw)</span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>lnincome<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(m_indrespt<span class="sc">$</span>lnincome)</span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>fasesXage<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(m_indrespt<span class="sc">$</span>fasesXage)</span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>fases<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(m_indrespt<span class="sc">$</span>fases)</span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>mases<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">zap_labels</span>(m_indrespt<span class="sc">$</span>mases)</span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a><span class="co">#m_sex_dv,m_urban_dv,lvpab</span></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a><span class="co">#as factor</span></span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>m_mastat_dv<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>m_mastat_dv)</span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>m_strata<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>m_strata)</span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>m_psu<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>m_psu)</span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>m_nchild_dv<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>m_nchild_dv)</span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>lvpab<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>lvpab)</span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>racel<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>racel)</span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>ledes<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>ledes)</span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>leave<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>leave)</span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>mawork <span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>mawork)</span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>edu<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>edu)</span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>age_group<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>age_group)</span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>paedu <span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>paedu )</span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>maedu  <span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>maedu )</span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>m_urban_dv<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>m_urban_dv)</span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a>m_indrespt<span class="sc">$</span>m_sex_dv<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">as_factor</span>(m_indrespt<span class="sc">$</span>m_sex_dv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#droplist: still using mice defaul</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>ImputeData <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">maxit =</span> <span class="dv">5</span>,<span class="at">method=</span><span class="cn">NULL</span>, <span class="at">droplist =</span> <span class="cn">NULL</span>) {</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">intersect</span>(<span class="fu">names</span>(data), droplist)) <span class="sc">&lt;</span> <span class="fu">length</span>(droplist)) {</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Droplist variables not found in data set"</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  predictorMatrix <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(data)))</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (term <span class="cf">in</span> droplist) {</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  drop.index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">names</span>(data) <span class="sc">==</span> term)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    predictorMatrix[, drop.index] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  mids.out <span class="ot">&lt;-</span> <span class="fu">mice</span>(data, <span class="at">m =</span> m, <span class="at">maxit =</span> maxit,<span class="at">method=</span>method,</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">predictorMatrix =</span> predictorMatrix)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mids.out)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Time difference of 39.56778 mins，Number of logged events: 374</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>imp_m<span class="ot">&lt;-</span><span class="fu">ImputeData</span>(m_indrespt,<span class="at">m=</span><span class="dv">1</span>,<span class="at">maxit =</span> <span class="dv">0</span>,<span class="at">droplist =</span> <span class="fu">c</span>(<span class="st">"m_indpxui_xw"</span>,<span class="st">"m_strata"</span>,<span class="st">"m_psu"</span>,<span class="st">"leave"</span> ))</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 16.466 secs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Time difference of 1.174014 hours；Number of logged events: 290</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>imp_a<span class="ot">&lt;-</span><span class="fu">ImputeData</span>(a_indrespt,<span class="at">m=</span><span class="dv">1</span>,<span class="at">maxit =</span> <span class="dv">0</span>,<span class="at">droplist =</span> <span class="fu">c</span>(<span class="st">"a_indinus_xw"</span>,<span class="st">"a_strata"</span>  , <span class="st">"a_psu"</span> ,<span class="st">"leave"</span> ))</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 45.56542 secs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#adjusting the methods</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>impmethod_m<span class="ot">&lt;-</span>imp_m<span class="sc">$</span>method</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>impmethod_m[<span class="st">"m_sex_dv"</span>]<span class="ot">&lt;-</span><span class="st">"logreg"</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>impmethod_m[<span class="st">"m_urban_dv"</span>]<span class="ot">&lt;-</span><span class="st">"logreg"</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>impmethod_m[<span class="st">"lvpab"</span>]<span class="ot">&lt;-</span><span class="st">"logreg"</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>impmethod_a<span class="ot">&lt;-</span>imp_a<span class="sc">$</span>method</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>impmethod_a[<span class="st">"a_sex_dv"</span>]<span class="ot">&lt;-</span><span class="st">"logreg"</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>impmethod_a[<span class="st">"a_urban_dv"</span>]<span class="ot">&lt;-</span><span class="st">"logreg"</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>impmethod_a[<span class="st">"lvpab"</span>]<span class="ot">&lt;-</span><span class="st">"logreg"</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Time difference of  35.07069 mins,Number of logged events: 373</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>imp_m<span class="ot">&lt;-</span><span class="fu">ImputeData</span>(m_indrespt,<span class="at">m=</span><span class="dv">5</span>,<span class="at">maxit =</span> <span class="dv">5</span>,<span class="at">droplist =</span> <span class="fu">c</span>(<span class="st">"m_indpxui_xw"</span>,<span class="st">"m_strata"</span>,<span class="st">"m_psu"</span>,<span class="st">"leave"</span> ),<span class="at">method=</span>impmethod_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Type mismatch for variable(s): m_sex_dv
Imputation method logreg is not for factors with &gt;2 levels.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Type mismatch for variable(s): m_urban_dv
Imputation method logreg is not for factors with &gt;2 levels.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage  paedu  maedu  mawork  leave  ledes
  1   2  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage  paedu  maedu  mawork  leave  ledes
  1   3  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome  fasesXage  paedu  maedu  mawork  leave  ledes
  1   4  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome  fasesXage*  paedu  maedu  mawork  leave  ledes
  1   5  m_mastat_dv  m_sex_dv  m_urban_dv  mases  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  2   1  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  2   2  m_mastat_dv  m_sex_dv  m_urban_dv  mases  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  2   3  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  2   4  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage  paedu  maedu  mawork  leave  ledes
  2   5  m_mastat_dv  m_sex_dv  m_urban_dv  mases  edu  age_group  lnincome  fasesXage*  paedu  maedu  mawork  leave  ledes
  3   1  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  3   2  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  3   3  m_mastat_dv  m_sex_dv  m_urban_dv  mases  edu  age_group  lnincome  fasesXage*  paedu  maedu  mawork  leave  ledes
  3   4  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  3   5  m_mastat_dv  m_sex_dv  m_urban_dv  mases  edu  age_group  lnincome*  fasesXage  paedu  maedu  mawork  leave  ledes
  4   1  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage  paedu  maedu  mawork  leave  ledes
  4   2  m_mastat_dv  m_sex_dv  m_urban_dv  mases  edu  age_group  lnincome  fasesXage*  paedu  maedu  mawork  leave  ledes
  4   3  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  4   4  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome  fasesXage*  paedu  maedu  mawork  leave  ledes
  4   5  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage  paedu  maedu  mawork  leave  ledes
  5   1  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome  fasesXage  paedu  maedu  mawork  leave  ledes
  5   2  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome  fasesXage*  paedu  maedu  mawork  leave  ledes
  5   3  m_mastat_dv  m_sex_dv  m_urban_dv  mases  edu  age_group  lnincome*  fasesXage*  paedu  maedu  mawork  leave  ledes
  5   4  m_mastat_dv  m_sex_dv  m_urban_dv  mases*  edu  age_group  lnincome*  fasesXage  paedu  maedu  mawork  leave  ledes
  5   5  m_mastat_dv  m_sex_dv  m_urban_dv  mases  edu  age_group  lnincome  fasesXage*  paedu  maedu  mawork  leave  ledes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 374</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 35.8615 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Time difference of 1.121355 hours；Number of logged events: 291</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>imp_a<span class="ot">&lt;-</span><span class="fu">ImputeData</span>(a_indrespt,<span class="at">m=</span><span class="dv">5</span>,<span class="at">maxit =</span> <span class="dv">5</span>,<span class="at">droplist =</span> <span class="fu">c</span>(<span class="st">"a_indinus_xw"</span>,<span class="st">"a_strata"</span>  , <span class="st">"a_psu"</span> ,<span class="st">"leave"</span> ),<span class="at">method=</span>impmethod_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Type mismatch for variable(s): a_sex_dv
Imputation method logreg is not for factors with &gt;2 levels.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Type mismatch for variable(s): a_urban_dv
Imputation method logreg is not for factors with &gt;2 levels.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome*  paedu  maedu  mawork  leave  ledes
  1   2  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  1   3  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome*  paedu  maedu  mawork  leave  ledes
  1   4  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  1   5  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  2   1  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  2   2  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  2   3  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  2   4  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  2   5  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome*  paedu  maedu  mawork  leave  ledes
  3   1  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  3   2  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome*  paedu  maedu  mawork  leave  ledes
  3   3  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  3   4  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  3   5  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  4   1  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  4   2  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  4   3  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  4   4  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome*  paedu  maedu  mawork  leave  ledes
  4   5  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  5   1  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  5   2  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  5   3  a_mastat_dv  a_sex_dv  mases*  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  5   4  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes
  5   5  a_mastat_dv  a_sex_dv  mases  edu  age_group  lnincome  paedu  maedu  mawork  leave  ledes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 289</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 1.251137 hours</code></pre>
</div>
</div>
</section>
<section id="wave-1-females" class="level3">
<h3 class="anchored" data-anchor-id="wave-1-females">Wave 1 females</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#with imputation: function built from https://gist.github.com/AaronGullickson/3ccb3fdd1778b32fc46df40d78faf5d3</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>lm_svy_af <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, imputations) {</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setting up null objects allows us to easily add results</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#later</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now loop through our imputations and run the model</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imputations<span class="sc">$</span>m) {</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#grab the complete dataset</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    imputation <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputations, i)</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the design effect object</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    imputation.svy <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>a_psu, <span class="at">strata=</span><span class="sc">~</span>a_strata, </span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>a_indinus_xw, <span class="at">data=</span>imputation),age_group<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>)<span class="sc">&amp;</span> a_sex_dv<span class="sc">==</span><span class="st">"Female"</span> )</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#run the model</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(formula, <span class="at">design=</span>imputation.svy,<span class="at">family=</span>quasibinomial)</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#collect the results</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">coef</span>(model))</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">cbind</span>(se, <span class="fu">summary</span>(model)<span class="sc">$</span>coef[,<span class="dv">2</span>])</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now pool the results</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>  b.pool <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, mean)</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>  between.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, var)</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>  within.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(se<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, mean)</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>  se.pool <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(within.var<span class="sc">+</span>between.var<span class="sc">+</span>between.var<span class="sc">/</span>imputations<span class="sc">$</span>m) </span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>  t.pool <span class="ot">&lt;-</span> b.pool<span class="sc">/</span>se.pool </span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>  pvalue.pool <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t.pool)))<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(b.pool, se.pool, t.pool, pvalue.pool)</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#we can also grap n and p from the last model since </span></span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#they should be the same across all iterations</span></span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model)</span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">length</span>(model<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return everything in a list</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">coef=</span>coefficients,</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">n=</span>n))</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="co"># for model 2 and 3 =============================================================</span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>lm_svy_af_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, imputations) {</span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setting up null objects allows us to easily add results</span></span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#later</span></span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now loop through our imputations and run the model</span></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imputations<span class="sc">$</span>m) {</span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">#grab the complete dataset</span></span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a>    imputation <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputations, i)</span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the design effect object</span></span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a>    imputation.svy <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>a_psu, <span class="at">strata=</span><span class="sc">~</span>a_strata, </span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>a_indinus_xw, <span class="at">data=</span>imputation),age_group<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>)<span class="sc">&amp;</span> a_sex_dv<span class="sc">==</span><span class="st">"Female"</span>  )</span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">#run the model</span></span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">svy_vglm</span>(formula, <span class="at">design=</span>imputation.svy,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>))</span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">#collect the results</span></span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">coef</span>(model))</span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">cbind</span>(se, <span class="fu">SE</span>(model))</span>
<span id="cb105-64"><a href="#cb105-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-65"><a href="#cb105-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-66"><a href="#cb105-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now pool the results</span></span>
<span id="cb105-67"><a href="#cb105-67" aria-hidden="true" tabindex="-1"></a>  b.pool <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, mean)</span>
<span id="cb105-68"><a href="#cb105-68" aria-hidden="true" tabindex="-1"></a>  between.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, var)</span>
<span id="cb105-69"><a href="#cb105-69" aria-hidden="true" tabindex="-1"></a>  within.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(se<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, mean)</span>
<span id="cb105-70"><a href="#cb105-70" aria-hidden="true" tabindex="-1"></a>  se.pool <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(within.var<span class="sc">+</span>between.var<span class="sc">+</span>between.var<span class="sc">/</span>imputations<span class="sc">$</span>m) </span>
<span id="cb105-71"><a href="#cb105-71" aria-hidden="true" tabindex="-1"></a>  t.pool <span class="ot">&lt;-</span> b.pool<span class="sc">/</span>se.pool </span>
<span id="cb105-72"><a href="#cb105-72" aria-hidden="true" tabindex="-1"></a>  pvalue.pool <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t.pool)))<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb105-73"><a href="#cb105-73" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(b.pool, se.pool, t.pool, pvalue.pool)</span>
<span id="cb105-74"><a href="#cb105-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-75"><a href="#cb105-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-76"><a href="#cb105-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-77"><a href="#cb105-77" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return everything in a list</span></span>
<span id="cb105-78"><a href="#cb105-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">coef=</span>coefficients))</span>
<span id="cb105-79"><a href="#cb105-79" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#running models</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co">#m1 Time difference of 5.143367 mins</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>m1af_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_af</span>(lvpab<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,imp_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 3.580413 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m2 Time difference of 18.08427 mins</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>m2af_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_af_2</span>(ledes<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,imp_a)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 15.42615 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 Time difference of 10.00591 mins</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>m3af_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_af_2</span>(leave<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,imp_a)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 7.82218 mins</code></pre>
</div>
</div>
</section>
<section id="wave-1-males" class="level3">
<h3 class="anchored" data-anchor-id="wave-1-males">Wave 1 males</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#with imputation: function built from https://gist.github.com/AaronGullickson/3ccb3fdd1778b32fc46df40d78faf5d3</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>lm_svy_am <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, imputations) {</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setting up null objects allows us to easily add results</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#later</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now loop through our imputations and run the model</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imputations<span class="sc">$</span>m) {</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#grab the complete dataset</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    imputation <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputations, i)</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the design effect object</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>    imputation.svy <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>a_psu, <span class="at">strata=</span><span class="sc">~</span>a_strata, </span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>a_indinus_xw, <span class="at">data=</span>imputation),age_group<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>)<span class="sc">&amp;</span> a_sex_dv<span class="sc">==</span><span class="st">"Male"</span>  )</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#run the model</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(formula, <span class="at">design=</span>imputation.svy,<span class="at">family=</span>quasibinomial)</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#collect the results</span></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">coef</span>(model))</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">cbind</span>(se, <span class="fu">summary</span>(model)<span class="sc">$</span>coef[,<span class="dv">2</span>])</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now pool the results</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>  b.pool <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, mean)</span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>  between.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, var)</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>  within.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(se<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, mean)</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>  se.pool <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(within.var<span class="sc">+</span>between.var<span class="sc">+</span>between.var<span class="sc">/</span>imputations<span class="sc">$</span>m) </span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>  t.pool <span class="ot">&lt;-</span> b.pool<span class="sc">/</span>se.pool </span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>  pvalue.pool <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t.pool)))<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(b.pool, se.pool, t.pool, pvalue.pool)</span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#we can also grap n and p from the last model since </span></span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#they should be the same across all iterations</span></span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model)</span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">length</span>(model<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return everything in a list</span></span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">coef=</span>coefficients,</span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">n=</span>n))</span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a><span class="co"># for model 2 and 3 =============================================================</span></span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a>lm_svy_am_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, imputations) {</span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setting up null objects allows us to easily add results</span></span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#later</span></span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-52"><a href="#cb123-52" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now loop through our imputations and run the model</span></span>
<span id="cb123-53"><a href="#cb123-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imputations<span class="sc">$</span>m) {</span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">#grab the complete dataset</span></span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true" tabindex="-1"></a>    imputation <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputations, i)</span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the design effect object</span></span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true" tabindex="-1"></a>    imputation.svy <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>a_psu, <span class="at">strata=</span><span class="sc">~</span>a_strata, </span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>a_indinus_xw, <span class="at">data=</span>imputation),age_group<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>)<span class="sc">&amp;</span> a_sex_dv<span class="sc">==</span><span class="st">"Male"</span> )</span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">#run the model</span></span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">svy_vglm</span>(formula, <span class="at">design=</span>imputation.svy,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>))</span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">#collect the results</span></span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">coef</span>(model))</span>
<span id="cb123-63"><a href="#cb123-63" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">cbind</span>(se, <span class="fu">SE</span>(model))</span>
<span id="cb123-64"><a href="#cb123-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now pool the results</span></span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true" tabindex="-1"></a>  b.pool <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, mean)</span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true" tabindex="-1"></a>  between.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, var)</span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true" tabindex="-1"></a>  within.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(se<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, mean)</span>
<span id="cb123-70"><a href="#cb123-70" aria-hidden="true" tabindex="-1"></a>  se.pool <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(within.var<span class="sc">+</span>between.var<span class="sc">+</span>between.var<span class="sc">/</span>imputations<span class="sc">$</span>m) </span>
<span id="cb123-71"><a href="#cb123-71" aria-hidden="true" tabindex="-1"></a>  t.pool <span class="ot">&lt;-</span> b.pool<span class="sc">/</span>se.pool </span>
<span id="cb123-72"><a href="#cb123-72" aria-hidden="true" tabindex="-1"></a>  pvalue.pool <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t.pool)))<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb123-73"><a href="#cb123-73" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(b.pool, se.pool, t.pool, pvalue.pool)</span>
<span id="cb123-74"><a href="#cb123-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-75"><a href="#cb123-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-76"><a href="#cb123-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-77"><a href="#cb123-77" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return everything in a list</span></span>
<span id="cb123-78"><a href="#cb123-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">coef=</span>coefficients))</span>
<span id="cb123-79"><a href="#cb123-79" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m1 Time difference of 5.283394 mins</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>m1am_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_am</span>(lvpab<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,imp_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 3.460296 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m2 Time difference of 17.32093 mins</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>m2am_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_am_2</span>(ledes<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,imp_a)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 12.93354 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 Time difference of 10.53404 mins</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>m3am_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_am_2</span>(leave<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,imp_a)</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 6.709317 mins</code></pre>
</div>
</div>
</section>
<section id="wave-13-females" class="level3">
<h3 class="anchored" data-anchor-id="wave-13-females">Wave 13 females</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#with imputation: function built from https://gist.github.com/AaronGullickson/3ccb3fdd1778b32fc46df40d78faf5d3</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>lm_svy_mf <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, imputations) {</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setting up null objects allows us to easily add results</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#later</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now loop through our imputations and run the model</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imputations<span class="sc">$</span>m) {</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#grab the complete dataset</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>    imputation <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputations, i)</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the design effect object</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>    imputation.svy <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>m_psu, <span class="at">strata=</span><span class="sc">~</span>m_strata, </span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>m_indpxui_xw, <span class="at">data=</span>imputation),age_group<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>)<span class="sc">&amp;</span> m_sex_dv<span class="sc">==</span><span class="st">"Female"</span> )</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#run the model</span></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(formula, <span class="at">design=</span>imputation.svy,<span class="at">family=</span>quasibinomial)</span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#collect the results</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">coef</span>(model))</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">cbind</span>(se, <span class="fu">summary</span>(model)<span class="sc">$</span>coef[,<span class="dv">2</span>])</span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now pool the results</span></span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>  b.pool <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, mean)</span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a>  between.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, var)</span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a>  within.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(se<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, mean)</span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a>  se.pool <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(within.var<span class="sc">+</span>between.var<span class="sc">+</span>between.var<span class="sc">/</span>imputations<span class="sc">$</span>m) </span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a>  t.pool <span class="ot">&lt;-</span> b.pool<span class="sc">/</span>se.pool </span>
<span id="cb141-30"><a href="#cb141-30" aria-hidden="true" tabindex="-1"></a>  pvalue.pool <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t.pool)))<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb141-31"><a href="#cb141-31" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(b.pool, se.pool, t.pool, pvalue.pool)</span>
<span id="cb141-32"><a href="#cb141-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-33"><a href="#cb141-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#we can also grap n and p from the last model since </span></span>
<span id="cb141-34"><a href="#cb141-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#they should be the same across all iterations</span></span>
<span id="cb141-35"><a href="#cb141-35" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model)</span>
<span id="cb141-36"><a href="#cb141-36" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">length</span>(model<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb141-37"><a href="#cb141-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-38"><a href="#cb141-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return everything in a list</span></span>
<span id="cb141-39"><a href="#cb141-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">coef=</span>coefficients,</span>
<span id="cb141-40"><a href="#cb141-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">n=</span>n))</span>
<span id="cb141-41"><a href="#cb141-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-42"><a href="#cb141-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-43"><a href="#cb141-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-44"><a href="#cb141-44" aria-hidden="true" tabindex="-1"></a><span class="co"># for model 2 and 3 =============================================================</span></span>
<span id="cb141-45"><a href="#cb141-45" aria-hidden="true" tabindex="-1"></a>lm_svy_mf_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, imputations) {</span>
<span id="cb141-46"><a href="#cb141-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb141-47"><a href="#cb141-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-48"><a href="#cb141-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setting up null objects allows us to easily add results</span></span>
<span id="cb141-49"><a href="#cb141-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#later</span></span>
<span id="cb141-50"><a href="#cb141-50" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb141-51"><a href="#cb141-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-52"><a href="#cb141-52" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now loop through our imputations and run the model</span></span>
<span id="cb141-53"><a href="#cb141-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imputations<span class="sc">$</span>m) {</span>
<span id="cb141-54"><a href="#cb141-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">#grab the complete dataset</span></span>
<span id="cb141-55"><a href="#cb141-55" aria-hidden="true" tabindex="-1"></a>    imputation <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputations, i)</span>
<span id="cb141-56"><a href="#cb141-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the design effect object</span></span>
<span id="cb141-57"><a href="#cb141-57" aria-hidden="true" tabindex="-1"></a>    imputation.svy <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>m_psu, <span class="at">strata=</span><span class="sc">~</span>m_strata, </span>
<span id="cb141-58"><a href="#cb141-58" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>m_indpxui_xw, <span class="at">data=</span>imputation),age_group<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>)<span class="sc">&amp;</span> m_sex_dv<span class="sc">==</span><span class="st">"Female"</span> )</span>
<span id="cb141-59"><a href="#cb141-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">#run the model</span></span>
<span id="cb141-60"><a href="#cb141-60" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">svy_vglm</span>(formula, <span class="at">design=</span>imputation.svy,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>))</span>
<span id="cb141-61"><a href="#cb141-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">#collect the results</span></span>
<span id="cb141-62"><a href="#cb141-62" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">coef</span>(model))</span>
<span id="cb141-63"><a href="#cb141-63" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">cbind</span>(se, <span class="fu">SE</span>(model))</span>
<span id="cb141-64"><a href="#cb141-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-65"><a href="#cb141-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-66"><a href="#cb141-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now pool the results</span></span>
<span id="cb141-67"><a href="#cb141-67" aria-hidden="true" tabindex="-1"></a>  b.pool <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, mean)</span>
<span id="cb141-68"><a href="#cb141-68" aria-hidden="true" tabindex="-1"></a>  between.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, var)</span>
<span id="cb141-69"><a href="#cb141-69" aria-hidden="true" tabindex="-1"></a>  within.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(se<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, mean)</span>
<span id="cb141-70"><a href="#cb141-70" aria-hidden="true" tabindex="-1"></a>  se.pool <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(within.var<span class="sc">+</span>between.var<span class="sc">+</span>between.var<span class="sc">/</span>imputations<span class="sc">$</span>m) </span>
<span id="cb141-71"><a href="#cb141-71" aria-hidden="true" tabindex="-1"></a>  t.pool <span class="ot">&lt;-</span> b.pool<span class="sc">/</span>se.pool </span>
<span id="cb141-72"><a href="#cb141-72" aria-hidden="true" tabindex="-1"></a>  pvalue.pool <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t.pool)))<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb141-73"><a href="#cb141-73" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(b.pool, se.pool, t.pool, pvalue.pool)</span>
<span id="cb141-74"><a href="#cb141-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-75"><a href="#cb141-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-76"><a href="#cb141-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-77"><a href="#cb141-77" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return everything in a list</span></span>
<span id="cb141-78"><a href="#cb141-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">coef=</span>coefficients))</span>
<span id="cb141-79"><a href="#cb141-79" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">#running models</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co">#m1 Time difference of 2.939297 mins</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>m1bf_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_mf</span>(lvpab<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,imp_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 2.149473 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m2 Time difference of 8.87294 mins</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>m2bf_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_mf_2</span>(ledes<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,imp_m)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 8.97587 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 Time difference of 4.866161 mins</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>m3bf_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_mf_2</span>(leave<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,imp_m)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 4.480453 mins</code></pre>
</div>
</div>
</section>
<section id="wave-13-males" class="level3">
<h3 class="anchored" data-anchor-id="wave-13-males">Wave 13 males</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#with imputation: function built from https://gist.github.com/AaronGullickson/3ccb3fdd1778b32fc46df40d78faf5d3</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>lm_svy_mm <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, imputations) {</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setting up null objects allows us to easily add results</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#later</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now loop through our imputations and run the model</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imputations<span class="sc">$</span>m) {</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#grab the complete dataset</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>    imputation <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputations, i)</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the design effect object</span></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>    imputation.svy <span class="ot">&lt;-</span><span class="fu">subset</span>(<span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>m_psu, <span class="at">strata=</span><span class="sc">~</span>m_strata, </span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>m_indpxui_xw, <span class="at">data=</span>imputation),age_group<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>)<span class="sc">&amp;</span> m_sex_dv<span class="sc">==</span><span class="st">"Male"</span>)</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#run the model</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(formula, <span class="at">design=</span>imputation.svy,<span class="at">family=</span>quasibinomial)</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#collect the results</span></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">coef</span>(model))</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">cbind</span>(se, <span class="fu">summary</span>(model)<span class="sc">$</span>coef[,<span class="dv">2</span>])</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now pool the results</span></span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>  b.pool <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, mean)</span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>  between.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, var)</span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>  within.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(se<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, mean)</span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>  se.pool <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(within.var<span class="sc">+</span>between.var<span class="sc">+</span>between.var<span class="sc">/</span>imputations<span class="sc">$</span>m) </span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>  t.pool <span class="ot">&lt;-</span> b.pool<span class="sc">/</span>se.pool </span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>  pvalue.pool <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t.pool)))<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(b.pool, se.pool, t.pool, pvalue.pool)</span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#we can also grap n and p from the last model since </span></span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#they should be the same across all iterations</span></span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model)</span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">length</span>(model<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb159-38"><a href="#cb159-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-39"><a href="#cb159-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return everything in a list</span></span>
<span id="cb159-40"><a href="#cb159-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">coef=</span>coefficients,</span>
<span id="cb159-41"><a href="#cb159-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">n=</span>n))</span>
<span id="cb159-42"><a href="#cb159-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-43"><a href="#cb159-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-44"><a href="#cb159-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-45"><a href="#cb159-45" aria-hidden="true" tabindex="-1"></a><span class="co"># for model 2 and 3 =============================================================</span></span>
<span id="cb159-46"><a href="#cb159-46" aria-hidden="true" tabindex="-1"></a>lm_svy_mm_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, imputations) {</span>
<span id="cb159-47"><a href="#cb159-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb159-48"><a href="#cb159-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-49"><a href="#cb159-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setting up null objects allows us to easily add results</span></span>
<span id="cb159-50"><a href="#cb159-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#later</span></span>
<span id="cb159-51"><a href="#cb159-51" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb159-52"><a href="#cb159-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-53"><a href="#cb159-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now loop through our imputations and run the model</span></span>
<span id="cb159-54"><a href="#cb159-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imputations<span class="sc">$</span>m) {</span>
<span id="cb159-55"><a href="#cb159-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#grab the complete dataset</span></span>
<span id="cb159-56"><a href="#cb159-56" aria-hidden="true" tabindex="-1"></a>    imputation <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputations, i)</span>
<span id="cb159-57"><a href="#cb159-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the design effect object</span></span>
<span id="cb159-58"><a href="#cb159-58" aria-hidden="true" tabindex="-1"></a>    imputation.svy <span class="ot">&lt;-</span><span class="fu">subset</span>(<span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>m_psu, <span class="at">strata=</span><span class="sc">~</span>m_strata, </span>
<span id="cb159-59"><a href="#cb159-59" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>m_indpxui_xw, <span class="at">data=</span>imputation),age_group<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>)<span class="sc">&amp;</span> m_sex_dv<span class="sc">==</span><span class="st">"Male"</span>)</span>
<span id="cb159-60"><a href="#cb159-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb159-61"><a href="#cb159-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">#run the model</span></span>
<span id="cb159-62"><a href="#cb159-62" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">svy_vglm</span>(formula, <span class="at">design=</span>imputation.svy,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>))</span>
<span id="cb159-63"><a href="#cb159-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">#collect the results</span></span>
<span id="cb159-64"><a href="#cb159-64" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(b, <span class="fu">coef</span>(model))</span>
<span id="cb159-65"><a href="#cb159-65" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">cbind</span>(se, <span class="fu">SE</span>(model))</span>
<span id="cb159-66"><a href="#cb159-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb159-67"><a href="#cb159-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-68"><a href="#cb159-68" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now pool the results</span></span>
<span id="cb159-69"><a href="#cb159-69" aria-hidden="true" tabindex="-1"></a>  b.pool <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, mean)</span>
<span id="cb159-70"><a href="#cb159-70" aria-hidden="true" tabindex="-1"></a>  between.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(b, <span class="dv">1</span>, var)</span>
<span id="cb159-71"><a href="#cb159-71" aria-hidden="true" tabindex="-1"></a>  within.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(se<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, mean)</span>
<span id="cb159-72"><a href="#cb159-72" aria-hidden="true" tabindex="-1"></a>  se.pool <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(within.var<span class="sc">+</span>between.var<span class="sc">+</span>between.var<span class="sc">/</span>imputations<span class="sc">$</span>m) </span>
<span id="cb159-73"><a href="#cb159-73" aria-hidden="true" tabindex="-1"></a>  t.pool <span class="ot">&lt;-</span> b.pool<span class="sc">/</span>se.pool </span>
<span id="cb159-74"><a href="#cb159-74" aria-hidden="true" tabindex="-1"></a>  pvalue.pool <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t.pool)))<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb159-75"><a href="#cb159-75" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(b.pool, se.pool, t.pool, pvalue.pool)</span>
<span id="cb159-76"><a href="#cb159-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-77"><a href="#cb159-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-78"><a href="#cb159-78" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return everything in a list</span></span>
<span id="cb159-79"><a href="#cb159-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">coef=</span>coefficients))</span>
<span id="cb159-80"><a href="#cb159-80" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m1 Time difference of 3.179687 mins</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>m1bm_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_mm</span>(lvpab<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,imp_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 2.039369 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m2 Time difference of 8.01764 mins</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>m2bm_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_mm_2</span>(ledes<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,imp_m)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 6.972031 mins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 Time difference of 4.359161 mins</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>m3bm_imp<span class="ot">&lt;-</span><span class="fu">lm_svy_mm_2</span>(leave<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,imp_m)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>end.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>time.taken <span class="ot">&lt;-</span> end.time <span class="sc">-</span> start.time </span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>time.taken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 4.448943 mins</code></pre>
</div>
</div>
</section>
</section>
<section id="plotting-results" class="level2">
<h2 class="anchored" data-anchor-id="plotting-results">Plotting results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>convertModel <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  tr <span class="ot">&lt;-</span> <span class="fu">createTexreg</span>(</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">coef.names =</span> <span class="fu">rownames</span>(model<span class="sc">$</span>coef), </span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">coef =</span> model<span class="sc">$</span>coef<span class="sc">$</span>b.pool, </span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> model<span class="sc">$</span>coef<span class="sc">$</span>se.pool, </span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvalues =</span> model<span class="sc">$</span>coef<span class="sc">$</span>pvalue.pool,</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="co">#omit&lt;-c("(Intercept):1", "(Intercept):2", "age_group21-25:1","age_group21-25:2","age_group26-30:1","age_group26-30:2" ,"age_group31-35:1","age_group31-35:2","factor(edu)middle:1", "factor(edu)middle:2", "factor(edu)high:1", "factor(edu)high:2", "factor(racel)African Caribbean:1",   "factor(racel)African Caribbean:2" , "factor(racel)Indiani,Pakistani, Bangladeshi:1", "factor(racel)Indiani,Pakistani, Bangladeshi:2" ,   "factor(racel)Other Asian:1",     "factor(racel)Other Asian:2","factor(racel)Other:1", "factor(racel)Other:2", "m_urban_dvrural area:1", "m_urban_dvrural area:2" )</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="co">#compare males and females in wave 1</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a> af_m1<span class="ot">&lt;-</span><span class="fu">screenreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m1af_imp, m1am_imp), convertModel))</span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a> af_m2<span class="ot">&lt;-</span><span class="fu">screenreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m2af_imp, m2am_imp), convertModel))</span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a> af_m3<span class="ot">&lt;-</span><span class="fu">htmlreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m3af_imp, m3am_imp), convertModel),<span class="at">file=</span><span class="st">"compare males and females in wave 1(2).html"</span>,<span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Females"</span>, <span class="st">"Males"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The table was written to the file 'compare males and females in wave 1(2).html'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare males and females in wave 13</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a> mf_m1<span class="ot">&lt;-</span><span class="fu">screenreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m1bf_imp, m1bm_imp), convertModel))</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a> mf_m2<span class="ot">&lt;-</span><span class="fu">screenreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m2bf_imp, m2bm_imp), convertModel))</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a> mf_m3<span class="ot">&lt;-</span><span class="fu">htmlreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m3bf_imp, m3bm_imp), convertModel),<span class="at">file=</span><span class="st">"compare males and females in wave 13(2).html"</span>,<span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Females"</span>, <span class="st">"Males"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The table was written to the file 'compare males and females in wave 13(2).html'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare females in wave 13 and wave 1</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a> bf_m1<span class="ot">&lt;-</span><span class="fu">screenreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m1af_imp, m1bf_imp), convertModel))</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a> bf_m2<span class="ot">&lt;-</span><span class="fu">screenreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m2af_imp, m2bf_imp), convertModel))</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a> bf_m3<span class="ot">&lt;-</span><span class="fu">htmlreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m3af_imp, m3bf_imp), convertModel),<span class="at">file=</span><span class="st">"compare females in wave 13 and wave 1(2).html"</span>,<span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Wave 1"</span>, <span class="st">"Wave 13"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The table was written to the file 'compare females in wave 13 and wave 1(2).html'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#compare males in wave 13 and wave 1</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a> bm_m1<span class="ot">&lt;-</span><span class="fu">screenreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m1am_imp, m1bm_imp), convertModel))</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a> bm_m2<span class="ot">&lt;-</span><span class="fu">screenreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m2am_imp, m2bm_imp), convertModel))</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a> bm_m3<span class="ot">&lt;-</span><span class="fu">htmlreg</span>(<span class="fu">lapply</span>(<span class="fu">list</span>(m3am_imp, m3bm_imp), convertModel),<span class="at">file=</span><span class="st">"compare males in wave 13 and wave 1(2).html"</span>,<span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Wave 1"</span>, <span class="st">"Wave 13"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The table was written to the file 'compare males in wave 13 and wave 1(2).html'.</code></pre>
</div>
</div>
</section>
<section id="assumption-checking" class="level2">
<h2 class="anchored" data-anchor-id="assumption-checking">Assumption checking</h2>
<section id="imputation" class="level3">
<h3 class="anchored" data-anchor-id="imputation">imputation</h3>
<p><a href="https://stats.oarc.ucla.edu/r/faq/how-do-i-perform-multiple-imputation-using-predictive-mean-matching-in-r/" class="uri">https://stats.oarc.ucla.edu/r/faq/how-do-i-perform-multiple-imputation-using-predictive-mean-matching-in-r/</a>&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>a_indrespy<span class="ot">&lt;-</span>a_indresp[<span class="fu">which</span>(a_indresp<span class="sc">$</span>a_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">35</span>)),]</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>m_indrespy<span class="ot">&lt;-</span>m_indresp[<span class="fu">which</span>(m_indresp<span class="sc">$</span>m_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">35</span>)),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">marginplot</span>(m_indrespt[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">16</span>)], <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="UKHLS-exploration--weighted-kin--4.6-merging-fa-ma-_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The box plots are blue for observed values and red for missing values</p>
<p>Evidence supporting MAR over MCAR would be if the distribution of&nbsp;<strong>x2</strong> for those observations with missing information for&nbsp;<strong>y1</strong> or&nbsp;<strong>y4</strong> were much higher or much lower than those of the non-missing observations. In the above graph, the boxplots appear to mostly overlap once again providing support for the assumption of MCAR.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbox</span>(a_indrespt, <span class="at">pos =</span> <span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in createPlot(main, sub, xlab, ylab, labels, ca$at): not enough space
to display frequencies</code></pre>
</div>
<div class="cell-output-display">
<p><img src="UKHLS-exploration--weighted-kin--4.6-merging-fa-ma-_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbox</span>(m_indresp, <span class="at">pos =</span> <span class="dv">17</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in createPlot(main, sub, xlab, ylab, labels, ca$at): not enough space
to display frequencies</code></pre>
</div>
<div class="cell-output-display">
<p><img src="UKHLS-exploration--weighted-kin--4.6-merging-fa-ma-_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="models" class="level3">
<h3 class="anchored" data-anchor-id="models">Models</h3>
</section>
</section>
</section>
<section id="model-building-without-imputations" class="level1">
<h1>Model building without imputations</h1>
<section id="adopt-the-weightings" class="level2">
<h2 class="anchored" data-anchor-id="adopt-the-weightings">Adopt the Weightings</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu=</span><span class="st">"adjust"</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>svy_indresp1 <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>a_psu, <span class="at">strata=</span><span class="sc">~</span>a_strata, </span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights=</span><span class="sc">~</span>a_indinus_xw, <span class="at">data=</span>a_indresp)</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>svy_indresp2 <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>m_psu, <span class="at">strata=</span><span class="sc">~</span>m_strata,<span class="at">weights=</span><span class="sc">~</span>m_indpxui_xw, <span class="at">data=</span>m_indresp)</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="co">#subset the data for respondents aged 25-50</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>svy_indresp1y<span class="ot">&lt;-</span><span class="fu">subset</span>(svy_indresp1, a_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">35</span>))</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>svy_indresp2y<span class="ot">&lt;-</span><span class="fu">subset</span>(svy_indresp2, m_age_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">35</span>))</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="co">#for males and females</span></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="co">#females</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>svy_indresp1yf<span class="ot">&lt;-</span><span class="fu">subset</span>(svy_indresp1y, a_sex_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">2</span>))</span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>svy_indresp2yf<span class="ot">&lt;-</span><span class="fu">subset</span>(svy_indresp2y, m_sex_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">2</span>))</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a><span class="co">#males</span></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>svy_indresp1ym<span class="ot">&lt;-</span><span class="fu">subset</span>(svy_indresp1y, a_sex_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>svy_indresp2ym<span class="ot">&lt;-</span><span class="fu">subset</span>(svy_indresp2y, m_sex_dv<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-1" class="level2">
<h2 class="anchored" data-anchor-id="model-1">Model 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for females</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="co">#without imputation </span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co">#females</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>m1af<span class="ot">&lt;-</span><span class="fu">svyglm</span>(lvpab<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,<span class="at">design=</span>svy_indresp1yf,<span class="at">na.action=</span>na.omit,<span class="at">family=</span>quasibinomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(glm.object): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>m1bf<span class="ot">&lt;-</span><span class="fu">svyglm</span>(lvpab<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,<span class="at">design=</span>svy_indresp2yf,<span class="at">na.action=</span>na.omit,<span class="at">family=</span>quasibinomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion

Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#males</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>m1am<span class="ot">&lt;-</span><span class="fu">svyglm</span>(lvpab<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,<span class="at">design=</span>svy_indresp1ym,<span class="at">na.action=</span>na.omit,<span class="at">family=</span>quasibinomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion

Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>m1bm<span class="ot">&lt;-</span><span class="fu">svyglm</span>(lvpab<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,<span class="at">design=</span>svy_indresp2ym,<span class="at">na.action=</span>na.omit,<span class="at">family=</span>quasibinomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion

Warning in summary.glm(g): observations with zero weight not used for
calculating dispersion</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co">#z tests of coefficients</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>zscore <span class="ot">&lt;-</span> <span class="cf">function</span>(coef2,coef1,se2,se1){(coef2<span class="sc">-</span>coef1)<span class="sc">/</span><span class="fu">sqrt</span>((se2)<span class="sc">**</span><span class="dv">2</span><span class="sc">+</span>(se1)<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co">#females </span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="co">#fases</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="fl">1.35783</span>  , <span class="at">coef1=</span>  <span class="fl">0.493502</span>       , <span class="at">se2=</span> <span class="fl">0.46276</span> , <span class="at">se1=</span> <span class="fl">0.084185</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.837607</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co">#maedu (high)</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span> <span class="sc">-</span><span class="fl">0.16265</span>      ,<span class="at">coef1=</span> <span class="sc">-</span><span class="fl">0.484515</span>      , <span class="at">se2=</span><span class="fl">0.53702</span>   , <span class="at">se1=</span><span class="fl">0.202592</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5607762</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co">#paedu (high)</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>   <span class="fl">0.50519</span>       ,<span class="at">coef1=</span>  <span class="sc">-</span><span class="fl">0.200648</span>       , <span class="at">se2=</span><span class="fl">0.57399</span>   , <span class="at">se1=</span><span class="fl">0.185489</span>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.170123</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mawork sig</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>  <span class="sc">-</span><span class="fl">0.38087</span>             , <span class="at">coef1=</span>  <span class="fl">0.359646</span>         , <span class="at">se2=</span> <span class="fl">0.31075</span>    , <span class="at">se1=</span> <span class="fl">0.113000</span>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.239524</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co">#males </span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co">#fases</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>  <span class="fl">0.77227</span>           ,<span class="at">coef1=</span>   <span class="fl">0.292779</span>         , <span class="at">se2=</span>  <span class="fl">0.66703</span> , <span class="at">se1=</span>  <span class="fl">0.093648</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7118632</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co">#maedu (high)</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="sc">-</span><span class="fl">0.79371</span>           ,<span class="at">coef1=</span><span class="sc">-</span><span class="fl">0.188297</span>        , <span class="at">se2=</span><span class="fl">0.63461</span>   , <span class="at">se1=</span><span class="fl">0.218553</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9020002</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co">#paedu (high)</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>   <span class="sc">-</span><span class="fl">0.19252</span>             ,<span class="at">coef1=</span> <span class="sc">-</span><span class="fl">0.320714</span>          , <span class="at">se2=</span><span class="fl">0.58333</span>   , <span class="at">se1=</span><span class="fl">0.218249</span>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2058279</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mawork sig</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>  <span class="sc">-</span><span class="fl">0.63024</span>              , <span class="at">coef1=</span> <span class="fl">0.181253</span>           , <span class="at">se2=</span> <span class="fl">0.35183</span>    , <span class="at">se1=</span>  <span class="fl">0.131726</span>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.16006</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ames</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="co">#females difference -0.122  p.value  0.021</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>cames<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">marginaleffects</span>(m1af,<span class="at">variables=</span><span class="st">"mawork"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: This function has been renamed to `slopes()`. The `marginaleffects()`
  alias will be removed in the near future.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>cames2<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">marginaleffects</span>(m1bf,<span class="at">variables=</span><span class="st">"mawork"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: This function has been renamed to `slopes()`. The `marginaleffects()`
  alias will be removed in the near future.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>came<span class="ot">&lt;-</span><span class="fu">rbind</span>(cames,cames2)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare.margins</span>(came<span class="sc">$</span>estimate,came<span class="sc">$</span>std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$difference
[1] -0.122

$p.value
[1] 0.021</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co">#males difference -0.141; p.value  0.017</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>cames<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">marginaleffects</span>(m1am,<span class="at">variables=</span><span class="st">"mawork"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: This function has been renamed to `slopes()`. The `marginaleffects()`
  alias will be removed in the near future.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>cames2<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">marginaleffects</span>(m1bm,<span class="at">variables=</span><span class="st">"mawork"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: This function has been renamed to `slopes()`. The `marginaleffects()`
  alias will be removed in the near future.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>came<span class="ot">&lt;-</span><span class="fu">rbind</span>(cames,cames2)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare.margins</span>(came<span class="sc">$</span>estimate,came<span class="sc">$</span>std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$difference
[1] -0.141

$p.value
[1] 0.017</code></pre>
</div>
</div>
</section>
<section id="model-2" class="level2">
<h2 class="anchored" data-anchor-id="model-2">Model 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>m2af<span class="ot">&lt;-</span><span class="fu">svy_vglm</span>(ledes<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>),<span class="at">design=</span>svy_indresp1yf,<span class="at">na.action=</span>na.omit)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>m2bf<span class="ot">&lt;-</span><span class="fu">svy_vglm</span>(ledes<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>),<span class="at">design=</span>svy_indresp2yf,<span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 2
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 3
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 5
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 6
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 6
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 6
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 7
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 8
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 8
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 8
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 8
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>m2am<span class="ot">&lt;-</span><span class="fu">svy_vglm</span>(ledes<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>),<span class="at">design=</span>svy_indresp1ym,<span class="at">na.action=</span>na.omit)</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>m2bm<span class="ot">&lt;-</span><span class="fu">svy_vglm</span>(ledes<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>),<span class="at">design=</span>svy_indresp2ym,<span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 1
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 1
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 2
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 6
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 6
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co">#z test for coefficients</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="co">#females</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="do">##cohabitation</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="do">###pases</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>  <span class="sc">-</span><span class="fl">1.145945</span>               ,<span class="at">coef1=</span>   <span class="sc">-</span><span class="fl">0.5279231</span>          , <span class="at">se2=</span>  <span class="fl">0.578323</span> , <span class="at">se1=</span> <span class="fl">0.1067982</span>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.050876</code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="do">###maedu(high)</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>  <span class="fl">0.535709</span>             ,<span class="at">coef1=</span>    <span class="fl">0.3910630</span>          , <span class="at">se2=</span>  <span class="fl">0.647512</span>   , <span class="at">se1=</span>  <span class="fl">0.2386345</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2096059</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="do">###paedu(high)</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span> <span class="sc">-</span><span class="fl">0.408988</span>           ,<span class="at">coef1=</span>   <span class="sc">-</span><span class="fl">0.0225736</span>         , <span class="at">se2=</span>  <span class="fl">0.690724</span>, <span class="at">se1=</span> <span class="fl">0.2202824</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5329859</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="do">###mawork </span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>  <span class="fl">0.247904</span>          ,<span class="at">coef1=</span>   <span class="sc">-</span><span class="fl">0.2549268</span>        , <span class="at">se2=</span>  <span class="fl">0.359905</span> , <span class="at">se1=</span>  <span class="fl">0.1396798</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.302469</code></pre>
</div>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="do">##marriage</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="do">###pases</span></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span> <span class="sc">-</span><span class="fl">1.358326</span>          ,<span class="at">coef1=</span>   <span class="sc">-</span><span class="fl">0.7566254</span>          , <span class="at">se2=</span>  <span class="fl">0.563529</span> , <span class="at">se1=</span> <span class="fl">0.1290402</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.040798</code></pre>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="do">###maedu(high)</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>   <span class="fl">0.358469</span>            ,<span class="at">coef1=</span>    <span class="fl">0.2141034</span>         , <span class="at">se2=</span>  <span class="fl">0.612275</span> , <span class="at">se1=</span>  <span class="fl">0.2432039</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2191313</code></pre>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="do">###paedu(high)</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>   <span class="sc">-</span><span class="fl">0.120479</span>          ,<span class="at">coef1=</span>    <span class="fl">0.3031643</span>          , <span class="at">se2=</span>  <span class="fl">0.632659</span>  , <span class="at">se1=</span>  <span class="fl">0.2209672</span>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6321739</code></pre>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="do">###mawork sig=1.97 not sig coefficient</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span> <span class="fl">0.391774</span>           ,<span class="at">coef1=</span>  <span class="sc">-</span><span class="fl">0.3863171</span>          , <span class="at">se2=</span>  <span class="fl">0.371241</span> , <span class="at">se1=</span>  <span class="fl">0.1345737</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.970451</code></pre>
</div>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="do">##without a partner</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="do">###pases</span></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>  <span class="sc">-</span><span class="fl">1.604960</span>        ,<span class="at">coef1=</span>    <span class="sc">-</span><span class="fl">0.4148343</span>           , <span class="at">se2=</span>  <span class="fl">0.626037</span> , <span class="at">se1=</span> <span class="fl">0.0975044</span>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.878401</code></pre>
</div>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="do">###maedu(high)</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="sc">-</span><span class="fl">0.165066</span>           ,<span class="at">coef1=</span>    <span class="fl">0.6751570</span>        , <span class="at">se2=</span>   <span class="fl">0.606883</span> , <span class="at">se1=</span>  <span class="fl">0.2180539</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.302938</code></pre>
</div>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="do">###paedu(high)</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="sc">-</span><span class="fl">0.915336</span>          ,<span class="at">coef1=</span>     <span class="fl">0.2940644</span>          , <span class="at">se2=</span>   <span class="fl">0.634411</span>  , <span class="at">se1=</span>   <span class="fl">0.2040251</span>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.814797</code></pre>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="do">###mawork sig=1.97 sig cof for wave 1, not sig for wave 13</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>  <span class="fl">0.384831</span>           ,<span class="at">coef1=</span>  <span class="sc">-</span><span class="fl">0.4305743</span>          , <span class="at">se2=</span>  <span class="fl">0.394867</span> , <span class="at">se1=</span>  <span class="fl">0.1235926</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.970733</code></pre>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co">#males</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="do">##cohabitation</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="do">###pases</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span> <span class="sc">-</span><span class="fl">0.1573351</span>         ,<span class="at">coef1=</span>    <span class="sc">-</span><span class="fl">0.4207956</span>           , <span class="at">se2=</span>  <span class="fl">0.8356579</span>  , <span class="at">se1=</span> <span class="fl">0.1462146</span>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3105553</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="do">###maedu(high)</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="fl">0.7581093</span>              ,<span class="at">coef1=</span>    <span class="fl">0.0648927</span>       , <span class="at">se2=</span>   <span class="fl">0.8468744</span> , <span class="at">se1=</span>  <span class="fl">0.2569212</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7833057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="do">###paedu(high)</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="sc">-</span><span class="fl">0.0895241</span>           ,<span class="at">coef1=</span>      <span class="sc">-</span><span class="fl">0.1840590</span>         , <span class="at">se2=</span>    <span class="fl">0.7805476</span>   , <span class="at">se1=</span>   <span class="fl">0.2627747</span>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1147835</code></pre>
</div>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">###mawork sig=2.09847 not sig coefficient</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>   <span class="fl">1.0827787</span>             ,<span class="at">coef1=</span>  <span class="sc">-</span><span class="fl">0.1310800</span>           , <span class="at">se2=</span>   <span class="fl">0.5570283</span>  , <span class="at">se1=</span>   <span class="fl">0.1559587</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.09847</code></pre>
</div>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="do">##marriage</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="do">###pases</span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span> <span class="sc">-</span><span class="fl">0.5434834</span>        ,<span class="at">coef1=</span>     <span class="sc">-</span><span class="fl">1.0634425</span>           , <span class="at">se2=</span>  <span class="fl">0.8331357</span>  , <span class="at">se1=</span> <span class="fl">0.1632331</span>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6124545</code></pre>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="do">###maedu(high)</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>     <span class="fl">1.4201381</span>               ,<span class="at">coef1=</span>   <span class="fl">0.2325718</span>        , <span class="at">se2=</span>    <span class="fl">0.7789965</span>   , <span class="at">se1=</span>  <span class="fl">0.2625822</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.44462</code></pre>
</div>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="do">###paedu(high)</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="sc">-</span><span class="fl">0.1181511</span>           ,<span class="at">coef1=</span>      <span class="fl">0.1469352</span>         , <span class="at">se2=</span>    <span class="fl">0.7352541</span>   , <span class="at">se1=</span>   <span class="fl">0.2439483</span>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3421938</code></pre>
</div>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="do">###mawork</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="fl">0.3984417</span>           ,<span class="at">coef1=</span>  <span class="sc">-</span><span class="fl">0.0598869</span>            , <span class="at">se2=</span>  <span class="fl">0.4306555</span>   , <span class="at">se1=</span>   <span class="fl">0.1543132</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.001882</code></pre>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="do">##without a partner</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="do">###pases</span></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span> <span class="sc">-</span><span class="fl">1.1276304</span>         ,<span class="at">coef1=</span>     <span class="sc">-</span><span class="fl">0.1783426</span>          , <span class="at">se2=</span>  <span class="fl">0.7328520</span> , <span class="at">se1=</span> <span class="fl">0.1021658</span>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.282927</code></pre>
</div>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="do">###maedu(high)</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>      <span class="fl">0.4877030</span>                ,<span class="at">coef1=</span>    <span class="fl">0.2378884</span>         , <span class="at">se2=</span>     <span class="fl">0.7266739</span>   , <span class="at">se1=</span>   <span class="fl">0.2431004</span>       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3260185</code></pre>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="do">###paedu(high)</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>     <span class="fl">0.6922228</span>           ,<span class="at">coef1=</span>       <span class="fl">0.6772597</span>          , <span class="at">se2=</span>    <span class="fl">0.6848506</span>    , <span class="at">se1=</span>   <span class="fl">0.2416268</span>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02060392</code></pre>
</div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="do">###mawork</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>    <span class="fl">0.5349542</span>             ,<span class="at">coef1=</span> <span class="sc">-</span><span class="fl">0.3293337</span>            , <span class="at">se2=</span>  <span class="fl">0.4310773</span>   , <span class="at">se1=</span>    <span class="fl">0.1505320</span>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.89286</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m2af sig </span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="co">#fases:1,2,3 -</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="co">#factor(mawork)working:1,3 -</span></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="co">#factor(maedu)high:3 +</span></span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a><span class="co">#m2bf sig</span></span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a><span class="co">#fases:1,2,3 -</span></span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a><span class="co">#m2am sig</span></span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a><span class="co">#fases:1,2,3 -</span></span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a><span class="co">#factor(mawork)working:3 -</span></span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a><span class="co">#m2bm sig none</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-3" class="level2">
<h2 class="anchored" data-anchor-id="model-3">Model 3</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>m3af<span class="ot">&lt;-</span><span class="fu">svy_vglm</span>(leave<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>),<span class="at">design=</span>svy_indresp1yf,<span class="at">na.action=</span>na.omit)</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>m3bf<span class="ot">&lt;-</span><span class="fu">svy_vglm</span>(leave<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>),<span class="at">design=</span>svy_indresp2yf,<span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 2
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 2
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 4
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 4
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 4
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 4
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 4
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 5
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 5
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 5
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12

Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 5
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>m3am<span class="ot">&lt;-</span><span class="fu">svy_vglm</span>(leave<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>a_urban_dv,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>),<span class="at">design=</span>svy_indresp1ym,<span class="at">na.action=</span>na.omit)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>m3bm<span class="ot">&lt;-</span><span class="fu">svy_vglm</span>(leave<span class="sc">~</span>fases<span class="sc">+</span>fasesXage<span class="sc">+</span>age_group<span class="sc">+</span><span class="fu">factor</span>(mawork)<span class="sc">+</span><span class="fu">factor</span>(maedu)<span class="sc">+</span><span class="fu">factor</span>(paedu)<span class="sc">+</span><span class="fu">factor</span>(edu)<span class="sc">+</span><span class="fu">factor</span>(racel)<span class="sc">+</span>m_urban_dv,<span class="at">family=</span><span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="dv">1</span>),<span class="at">design=</span>svy_indresp2ym,<span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 1
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 1
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 2
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkwz(wz, M = M, trace = trace, wzepsilon = control$wzepsilon): 3
diagonal elements of the working weights variable 'wz' have been replaced by
1.819e-12</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co">#z test for coefficients</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="co">#females</span></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="do">##with partners</span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="do">###pases</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2 =</span>     <span class="sc">-</span><span class="fl">1.4293392</span>                  ,<span class="at">coef1=</span>  <span class="sc">-</span><span class="fl">0.4570019</span>             , <span class="at">se2=</span>  <span class="fl">0.5268451</span>    , <span class="at">se1=</span>   <span class="fl">0.0878269</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.820463</code></pre>
</div>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="do">###maedu(high)</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="do">###paedu(high)</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a><span class="do">###mawork </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co">#m3bm sig</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="co">#mawork 2 +</span></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="co">#m3am sig</span></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="co">#fases 1,2 -</span></span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a><span class="co">#m3bf</span></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a><span class="co">#fases 1,2 -</span></span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a><span class="co">#m3af</span></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a><span class="co">#fases 1,2-</span></span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a><span class="co">#mawork 1,2-</span></span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a><span class="co">#maedu high +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co">#whether mother working when male respondents age 14 have higher predicability of home-leaving without a partner in wave 13 than wave 1</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="co">#mawork sig at wave 13 not wave 1</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2=</span>   <span class="fl">0.799274</span>      ,<span class="at">coef1=</span> <span class="sc">-</span><span class="fl">0.2217087</span>        ,<span class="at">se2=</span> <span class="fl">0.395233</span>   ,<span class="at">se1=</span> <span class="fl">0.1357911</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.443071</code></pre>
</div>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for females the effect direction is reversed, with effects only sig at wave 1</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zscore</span>(<span class="at">coef2=</span>    <span class="fl">0.3330332</span>      ,<span class="at">coef1=</span>  <span class="sc">-</span><span class="fl">0.3454488</span>         ,<span class="at">se2=</span> <span class="fl">0.3347052</span>   ,<span class="at">se1=</span>  <span class="fl">0.1172492</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.913116</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>testa<span class="ot">&lt;-</span>a_indresptf<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(leave,fases,fasesXage,age_group,mawork,maedu,paedu,edu,racel,a_urban_dv,a_sex_dv)</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>test1<span class="ot">&lt;-</span><span class="fu">complete.cases</span>(testa)</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>test1
FALSE  TRUE 
 3615  5690 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>testb<span class="ot">&lt;-</span>m_indrespt<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(leave,fases,fasesXage,age_group,mawork,maedu,paedu,edu,racel,m_urban_dv,m_sex_dv)</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>test2<span class="ot">&lt;-</span><span class="fu">complete.cases</span>(testb)</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>test2
FALSE  TRUE 
26833  1165 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co">#comple cases of males and females in wave 1 and 13: 434, 3927</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>